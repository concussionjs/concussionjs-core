<html>
<head>
	<title>Answer</title>
	<link rel="stylesheet" href="css/style.css">
  	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Pacifico" type="text/css">
  	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans" type="text/css">
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script language="JavaScript" src="js/search.js"></script>
    <script language="JavaScript" src="js/events.js"></script>
    <script language="JavaScript" src="http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.0.0.js"></script>
<script>	
	$(function() {

        	function Tag(data) {
                	var self=this;
                	//alert(data.name);
                	this.name=data.name;
        	}

        	function Question(data) {
                	var self = this;
			//alert(data.title);
                	this.title = ko.observable(data.title);
                	this.text = ko.observable(data.text);
                	//this.votes = ko.observable(data.votes);
                	//this.tags = $.map(data.tag,function(item){return new Tag(item)});
        	}

        	function QuestionListViewModel() {
                	// Data
                	var self = this;
			self.questionText = ko.observable();
			self.questionTitle = ko.observable();
                	self.questions = ko.observableArray([
                	]);

                	$.getJSON("http://demoqanda.nextera.com/questions", function(allData) {
                        	//alert(allData[0].text);
                        	var mappedQuestions = $.map(allData, function(item) { return new Question(item) });
                        	self.questions(mappedQuestions);
                	});

			self.addQuestion = function() {
                        	self.questions.push(new Question({ title: this.questionTitle(),text:this.questionText() }));
                        	self.save();
				self.questionTitle("");
                        	self.questionText("");
                	};
			
			self.save = function() {
        			$.ajax("/saveQuestions", {
            				data: ko.toJSON(new Question({ title: this.questionTitle(),text:this.questionText() })),
            				type: "post", contentType: "application/json",
            				success: function(result) { }
        			});
    			};			

        	}
		
		ko.applyBindings(new QuestionListViewModel());
	
	});

</script>
</head>
<body>
	<!-- Header -->
	<div id="header">
    	<span id="logo">Answers</span>
         <span id="searchContainer">        
            <input type="text" id="search" tabindex="1" onFocus="clearSearchDefault()" onBlur="searchBlur()" value="Search for an answer...">
            <img id="searchIcon" src="images/searchIcon.png">
            <img id="clearSearchIcon" src="images/clearSearchIcon.png" onMouseOver="clearSearchMouseOver()" onMouseOut="clearSearchMouseOut()" onClick="clearSearch()">  
   	  	</span>
      	<input type="button" class="button" value="Ask a Question">
	</div>
    <!-- End Header -->
	    
    <div id="feedTitle">My questions</div>
    <br><br>
	<form data-bind="submit: addQuestion">	
    		<input style="font-size:2em" class="result" data-bind="value: questionTitle" placeholder="Enter question title"/>
		<textarea style="font-size:2em" class="result" data-bind="value: questionText" placeholder="Enter question text"></textarea><br>
		<button style="margin:0 20px" type="submit" class="button">Submit your question</button>		
	</form>
    <!-- End Question -->
    <div data-bind="foreach:questions">
	<div data-bind="text:title"/><br>
    </div>

</body>
</html>
