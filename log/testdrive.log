port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download Virtual Box image to run a local copy of the Concussion platform.</p>
<p><a href="http://concussionjs.com/concussion.js">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID: xxxxxxxxxxx</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: listen EADDRINUSE
    at errnoException (net.js:646:11)
    at Array.0 (net.js:747:26)
    at EventEmitter._tickCallback (node.js:192:41)
sh: 1: Syntax error: word unexpected
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 2088
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart less than one second ago
mon : 10 attempts remaining
mon : child 2101
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 4 seconds ago
mon : 9 attempts remaining
mon : child 2111
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 4 seconds ago
mon : 8 attempts remaining
mon : child 2124
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 5 seconds ago
mon : 7 attempts remaining
mon : child 2137
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 5 seconds ago
mon : 6 attempts remaining
mon : child 2181
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 3 seconds ago
mon : 5 attempts remaining
mon : child 2210
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 3 seconds ago
mon : 4 attempts remaining
mon : child 2215
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 3 seconds ago
mon : 3 attempts remaining
mon : child 2220
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 3 seconds ago
mon : 2 attempts remaining
mon : child 2225
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : exit(1)
mon : sleep(1)
mon : last restart 3 seconds ago
mon : 1 attempts remaining
mon : 10 restarts within 37 seconds, bailing
mon : on error `(null) 2225`
mon : exit(512)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/index.ejs   /home/concussed/concussionjs-testdrive/index.html
<!DOCTYPE html>
<html>
<head>
	<title>ConcussionJS</title>
	<meta charset="utf-8">
	<meta name="description=" content="The web app platform for the impatient hacker. Concussion was built to minimize the work required to turn your HTML into a dynamic, database driven application. With Concussion, you focus on creating distinctive HTML, and the platform takes care of the rest - no proprietary javascript framework to learn, no data models to setup, no web services to create.">
	<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<script src="js/ace.js"></script>
	<script src="js/mode-html.js"></script>
	<script src="js/theme-concussion.js"></script>
	<script src="js/jquery-1.8.1.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/bqr1qnl.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script src="js/cjs-utilities.js" type="text/javascript"></script>	
	<script src="js/loadEditorContent.js" type="text/javascript"></script>
	<script>
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}

	</script>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
	<iframe id="synchSessionVariables" width=0 height=0 style="visibility:hidden;display:none"></iframe>
	<input type="radio" name="menu-control" id="menu1" checked>
	<input type="radio" name="menu-control" id="menu2">
	<input type="radio" name="menu-control" id="menu3">
	<input type="radio" name="menu-control" id="menu4">
	<input type="radio" name="menu-control" id="menu5">

	<section id="masthead">
		<header id="logo">concussion<span>js</span></header>
		<nav id="main-menu">
			<label for="menu1">Tutorial</label>
			<label for="menu2">How it works</label>
			<label for="menu3">Getting started</label>
			<label for="menu4">Documentation</label>
			<label for="menu5">About</label>
			<div id="menu-indicator"></div>
		</nav>
		<div id="auth-status">
			<div id="auth-loggedout">
				Login via <a class="masthead-icon" id="masthead-icon-facebook" title="Facebook"></a><!--<a class="masthead-icon" id="masthead-icon-twitter" title="Twitter"></a><a class="masthead-icon" id="masthead-icon-github" title="GitHub"></a>-->
			</div>
			<div id="auth-loggedin" class="auth-hide">
				<span id="auth-displayname"></span>
				<div id="auth-logoutlink" class="fb-login-button" data-width="200" data-max-rows="1"><a class="fb_button fb_button_medium"><span class="fb_button_text">Log Out</span></a></div>
			</div>
		</div>
	</section>
	
	<div id="pages">
		<div id="page-wrapper">
	
			<section id="tutorial" class="page">

				<input type="radio" name="step-control" id="step1" checked>
				<input type="radio" name="step-control" id="step2">
				<input type="radio" name="step-control" id="step3">
				<input type="radio" name="step-control" id="step4">
				<input type="radio" name="step-control" id="step5">
				<input type="radio" name="step-control" id="step6">
				<input type="radio" name="step-control" id="step7">
				<input type="radio" name="step-control" id="step8">
		
				<section id="instructions" class="panel">
					<header id="step-number">
						<div id="step-number-wrapper">
							<h1>Step 1</h1>
							<h1>Step 2</h1>
							<h1>Step 3</h1>
							<h1>Step 4</h1>
							<h1>Step 5</h1>
							<h1>Step 6</h1>
							<h1>Step 7</h1>
							<h1>Step 8</h1>
						</div>
					</header>
					<div id="next-prev">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
					<div id="steps">
						<div id="step-wrapper">

<!-- Step 1 -->
<article>

<header><span id="lede">The web app platform for the impatient hacker.</span></header>
<p>You provide the HTML. Concussion will use the markup to generate the web services, javascript, and admin tools to make your app work.</p>
<p>Follow this 8 step tutorial, and in 5 minutes you will have a working contacts app. You will define the basic view, create, edit, and delete functionality in the app.</p>
<p>To start, copy and paste the following markup into the editor, then press the refresh button in the preview (or push &ldquo;Just do it for me&rdquo;).</p>
<pre class="snippet large" id="s1e1" data-readonly="true" data-gutter="false">
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;&lt;title&gt;Contacts&lt;/title&gt;&lt;meta charset="utf-8"&gt;&lt;link rel="stylesheet" href="contacts-style.css"&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="contacts"&gt;
    &lt;div class="vcard"&gt;
      &lt;input class="fn" value="First Last"&gt;
      &lt;input class="email" value="address@email.com"&gt;
      &lt;input class="tel" value="+1.818.555.1212"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="action"><a class="justDoIt" data-index="0">Just do it for me&raquo;</a></p>
<p>You should see a sample contact appear in the preview.</p>
<p class="continue" ><label for="step2" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 1 -->


<!-- Step 2 -->
<article>

<header>Connect to the Concussion back-end</header>
<p>Next you will add special Concussion attributes to the elements in the markup that represent application data. These are called data-binds, and they tell Concussion how to wire up data from the back end to the user interface.</p>
<p>First, paste this reference to the Concussion javascript file in the head tag, after the stylesheet link.</p>
<pre class="snippet small" id="s2e1" data-readonly="true" data-gutter="false">
  &lt;script src="http://api.concussionjs.com/concussion.js"&gt;&lt;/script&gt;</pre>
<p class="action"><a class="justDoIt" data-index="6" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>Next, replace the contacts div with the following markup, then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s2e2" data-readonly="true" data-gutter="false">
  &lt;div id="contacts" data-bind="foreach:contacts"&gt;
	&lt;div class="vcard"&gt;
		&lt;input class="fn" data-bind="value:name"&gt;
		&lt;input class="email" data-bind="value:email"&gt;
		&lt;input class="tel" data-bind="value:phone"&gt;
    &lt;/div&gt;
  &lt;/div&gt;</pre>
<p class="action"><a class="justDoIt" data-index="1" data-addContacts="true">Just do it for me&raquo;</a></p>
<p>You should see the original static data defined in the HTML disappear. That data has been replaced with data from the backend, and in this case there is no data so no contacts show up.</p>
<p class="continue" data-addContacts="true"><label for="step3" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 2 -->


<!-- Step 3 -->
<article>

<header>Add contacts in admin</header>
<p>The Concussion admin app allows you to manage application data. It shows the objects and values specified in the markup, and the list of records for each object.</p>
<p>Add a contact by pressing the New button in the List. Fill out the fields below in the Details, then press the Save button.</p>
<p>Add 2 or 3 more records to show more data in the contacts app.</p>
<p class="continue" ><label for="step4" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 3 -->


<!-- Step 4 -->
<article>

<header>Add contacts directly from the app</header>
<p>You should see the contacts that were added from the admin.</p>
<p>Now add a form so contacts can be added directly from your app. Copy and paste the following markup into the editor, between the body element and the contacts div. Then press the refresh button in the preview.</p>
<pre class="snippet medium" id="s4e1" data-readonly="true" data-gutter="false">&lt;form data-bind="submit:contacts_create"&gt;
&lt;div class="new-contact"&gt;
  &lt;input class="fn" placeholder="Contact Name" data-bind="value:contacts_name"&gt;
  &lt;input class="email" placeholder="Email Address" data-bind="value:contacts_email"&gt;
  &lt;input class="phone" placeholder="Phone Number" data-bind="value:contacts_phone"&gt;
  &lt;button&gt;Add record&lt;/button&gt;    
&lt;/div&gt;
&lt;/form&gt;</pre>
<p class="action"><a class="justDoIt" data-index="2">Just do it for me&raquo;</a></p>
<p>You should see the add contacts form in the preview.</p>
<p>Now add a few more contacts using the new form. You should see the contacts appear in the list.</p>
<p class="continue" ><label for="step5" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 4 -->


<!-- Step 5 -->
<article>

<header>Add a new field</header>
<p>Concussion makes it easy to update the data used in the application. Let's add a birthday field to the contacts. First paste the following markup into the editor, in the new contact div below the phone input.</p>
<pre class="snippet small" id="s5e1" data-readonly="true" data-gutter="false">
	&lt;input class="bday" placeholder="Birthday" data-bind="value:contacts_Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="3">Just do it for me&raquo;</a></p>
<p>You should see the new field in the add contact form.</p>
<p>Next paste the following markup into the editor, in the contacts div below the phone input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s5e2" data-readonly="true" data-gutter="false">
	&lt;input class="bday" data-bind="value:Birthday"&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="4">Just do it for me&raquo;</a></p>
<p>In this case you will not see anything in the existing contacts, because they have no birthday data.</p>
<p>Add a few contacts using the new field. These should display all the data.</p>
<p class="continue" ><label for="step6" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 5 -->


<!-- Step 6 -->
<article>

<header>Update contacts in admin</header>
<p>In the admin app you can add birthdays to the existing contacts. Select a contact from the list, then enter the birthday in the field below and press save.</p>
<p class="continue" ><label for="step7" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 6 -->


<!-- Step 7 -->
<article>

<header>Update contacts directly from the app</header>
<p>You should see the updates to the contacts made in admin.</p>
<p>Now add save and delete buttons so that edits to contacts can be saved, and contacts can be deleted directly from your app.</p>
<p>Paste the following markup in the editor, in the contacts div below the birthday input. Then press the refresh button in the preview.</p>
<pre class="snippet small" id="s7e1" data-readonly="true" data-gutter="false">
	&lt;button data-bind="click:contacts_update"&gt;Save&lt;/button&gt;&lt;button class="secondary" data-bind="click:contacts_delete"&gt;Delete&lt;/button&gt;
</pre>
<p class="action"><a class="justDoIt" data-index="5">Just do it for me&raquo;</a></p>
<p>Edit a few contacts and click save to persist the changes. Press the delete button to remove the contact.</p>
<p class="continue" ><label for="step8" class="primary">Continue &raquo;</label></p>

</article>
<!-- Close Step 7 -->


<!-- Step 8 -->
<article>

<header>You've been Concussed!</header>
<p>Now go to the <label for="menu3">Getting started</label> page to learn how to install Concussion.</p>
<p>You can run Concussion initially as an anonymous user, and when you are ready create an account and start building apps.
<p>Have fun!</p>

</article>
<!-- Close Step 8 -->

						</div>
					</div>
					<div id="page-indicator">
						<label for="step1"></label>
						<label for="step2"></label>
						<label for="step3"></label>
						<label for="step4"></label>
						<label for="step5"></label>
						<label for="step6"></label>
						<label for="step7"></label>
						<label for="step8"></label>
					</div>
				</section>

				<section id="workspace">
					<section id="workspace-wrapper">
						<section id="front-end">
							<section id="markup" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"></div>
									<div class="panel-header-title">Editor</div>
									<div class="panel-header-secondary"></div>
								</header>
								<div class="panel-body">
									<div id="editor" class="editor" data-readonly="false" data-gutter="true"></div>
								</div>
							</section>
							<section id="view" class="panel">
								<header class="panel-header">
									<div class="panel-header-primary"><a class="panel-header-icon" id="panel-header-icon-refresh" title="Refresh"></a></div>
									<div class="panel-header-title">Preview</div>
									<div class="panel-header-secondary"><a class="panel-header-icon" id="panel-header-icon-new-window" title="Open in a new window" onclick="openUpPreviewWindow()"></a></div>
								</header>
								<div class="panel-body">
									<iframe src="contacts.html" id="preview"></iframe>
								</div>
							</section>
						</section>

						<section id="admin" class="panel">
							<header class="panel-header">
								<div class="panel-header-primary"></div>
								<div class="panel-header-title">Admin</div>
								<div class="panel-header-secondary"></div>
							</header>
							<div class="panel-body">
								<iframe src="admin.html" id="admin-app"></iframe>
							</div>
						</section>
				
					</section>
			
				</section>
	
			</section>

			<section id="howitworks" class="page">
				<img src="img/infographic.png" alt="How it works infographic">
			</section>
			
			<section id="download" class="page">
				<div class="page-body">

<h1>Create an account</h1>

<p>You can use Concussion as a hosted service, a locally deployable virtual appliance, and an Amazon Web Services (AWS) deployable image (AMI).</p>

<h1>Concussion JS File</h1>
<p>To start using Concussion you need to include the Concussion script in your HTML file.</p>
<p>You can use the hosted version of the file:</p>
<pre class="snippet small" id="hostedInclude" data-readonly="true" data-gutter="false">&lt;script src=“http://testdrive.concussionjs.com/concussion.js”&gt;</pre>
<p>Or download the file locally:</p>
<p><a href="http://api.concussionjs.com/concussion.js"> Download</a></p>

<h1>Virtual appliance download</h1>
<p>Download virtual appliance to run a local copy of the Concussion platform.</p>
<p><a href="https://s3.amazonaws.com/concussionjs/concussion-base-v0.1.ova">Download</a></p>

<h1>Amazon Web Servies</h1>
<p>Search for our AWS AMI using the ID below to launch and run your own Concussion instance on AWS</p>
<p>AMI ID:  ami-edae2084</p>

				</div>
			</section>

			<section id="documentation" class="page">
				<div class="page-body">

<h1>Documentation</h1>
<p>Concussionjs was built to minimize the work required to turn your HTML into a dynamic, database driven web application. Learning how to use Concussionjs is really simple, all you need to know is HTML and a just a little bit about database to get started.</p>
		
<!-- Navigation -->				
<h2>Navigation</h2>

<ul>
  
	<li><a href="#create">Creating Data</a></li>
	<li><a href="#read">Reading Data</a></li>
	<li><a href="#update">Updating Data</a></li>
	<li><a href="#delete">Deleting Data</a></li>
	<li><a href="#knockout">Knockout</a></li>
</ul>

<!-- Creating Data Object -->
<article>
	<h2>Creating Data</h2>
	<p>Create new entries in the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have a Contact form with three fields: Name, Email Address and Phone Number, something like this:</p>
	<pre id="help1" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Hook this static form up to a database by adding the following data-binds:</p>
	<pre id="help2" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-create" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Reading Data Object -->
<article>
	<h2>Reading Data</h2>
	<p>Read existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help3" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Reading data of the database by adding the following data-binds:</p>
		<pre id="help4" class="snippet medium" data-readonly="true" data-gutter="false">&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		&lt;/ul&gt;</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child elements. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”</p>
</article>

<!-- Updating Data Object -->
<article>
	<h2>Updating Data</h2>
	<p>Updating existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help5" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form&gt;
		    &lt;input placeholder="Name"&gt;
		    &lt;input placeholder="Email"&gt;
		    &lt;input placeholder="Phone"&gt;
		    &lt;input type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Updating data in the database by adding the following data-binds:</p>
	<pre id="help6" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;form data-bind="submit:contacts-create"&gt;
		    &lt;input data-bind="value:contacts_name"&gt;
		    &lt;input data-bind="value:contacts_email"&gt;
		    &lt;input data-bind="value:contacts_phone"&gt;
		    &lt;input data-bind="submit:contacts-update" type="submit"&gt;
		&lt;/form&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Delete Object -->
<article>
	<h2>Deleting Data</h2>
	<p>Deleting existing records outside of the database based on the children of the HTML element the data-bind is added to.</p>
	<p>Lets say you have an existing Contacts object in the database that has the following three fields: Name, Email Address, and Phone Number and you have the following HTML:</p>
	<pre id="help7" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul&gt;
		    &lt;li&gt;Name&lt;/li&gt;
		    &lt;li&gt;Email&lt;/li&gt;
		    &lt;li&gt;Phone&lt;/li&gt;
		&lt;/ul&gt;
	</pre>
	<p>Deleting data of the database by adding the following data-binds:</p>
		<pre id="help8" class="snippet medium" data-readonly="true" data-gutter="false">					
		&lt;ul data-bind="foreach:contacts"&gt;
		    &lt;li data-bind="value:contacts_name"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_email"&gt;&lt;/li&gt;
		    &lt;li data-bind="value:contacts_phone"&gt;&lt;/li&gt;
		     &lt;button data-bind="click:contacts-delete"&gt;Delete&lt;button&gt;
		&lt;/ul&gt;
	</pre>
	<p>Notice a data-bind attribute has been added to the parent form as well as the child inputs. ConcussionJS knows the input fields are part of the Contacts data object because they are (1) a child of the form and (2) because they reference the object in the data-bind=“value:objectName_value”.</p>
</article>

<!-- Knockout -->
<article>
	<h2>Knockout</h2>
	<p>desc</p>
	"}
	P:"
</article>	
				</div>
			</section>
						
			<section id="about" class="page">
				<div class="page-body">

					<h1>Why ConcussionJS?</h1>
					<p>ConcussionJS enables people with limited programming experience to create web apps without having to learn a proprietary JavaScript framework, create and manage a database, or build and run web servers and services.</p>

					<h1>Our Mission</h1>
					<p>Modern web and mobile applications have redefined our expectations for how easy software should be to use. Unfortunately, most software companies still spend the majority of their time focusing on just getting their app to work, not on meeting the needs of their users.</p>
					<p>Our mission is to radically reduce the time it takes to build apps. This is critical because designing useful, usable products is a numbers game. Developers and designers need to try many different solutions and evaluate them with users to see what works and what doesn't. The more design iterations you can do, the faster you can figure out what works and what doesn't. Then you can distill the remaining designs down to the solution that best satisfies the key workflows, information patterns, and interaction models needed by users to complete their work.</p>

					<h1>The People Behind ConcussionJS</h1>
					<h2>Ben Frenkel</h2>
					<p>
					Ben is currently a senior associate at McKinsey &amp; Co. He has an MBA from MIT. He has 10 years of experience in building model driven systems specializing in cloud platforms.
					</p>
					<h2>Brian Jamieson</h2>
					<p>
					Brian has 15 years of enterprise UX experience in healthcare, financial services, human capital management, and software development. He has founded user experience teams in multiple organizations. He has a Ph.D. in cognitive/experimental psychology.
					</p>
					<h2>Brian Del Giudice</h2>
					<p>Brian has 12 years of design experience at software, marketing and advertising companies. He created the pixeless open source icon library, and has experience working at multiple start-ups.
					</p>			
					
				</div>
			</section>
			
		</div>
	</div>

<script>

function getSizables() {
	sizables = new Array();
	sizables[0] = document.getElementById("editor");
	sizables[1] = document.getElementById("preview");
	sizables[2] = document.getElementById("admin-app");
	resizeSizables();
}

function resizeSizables() {
	var parent;
	for( var i=0; i<sizables.length; i++ ) {
		parent = sizables[i].parentNode;
		sizables[i].style.width = parent.offsetWidth -1 + "px";
		sizables[i].style.height = parent.offsetHeight -2 + "px";
	}
}
getSizables();
window.onresize = resizeSizables;

var iPadLabels = function () {
	function fix() {
		var labels = document.getElementsByTagName('label'), 
		target_id, 
		el;
		for (var i = 0; labels[i]; i++) {
			if (labels[i].getAttribute('for')) {
				labels[i].onclick = labelClick;
			}
		}
	};
	function labelClick() {
		el = document.getElementById(this.getAttribute('for'));
		if (['radio', 'checkbox'].indexOf(el.getAttribute('type')) != -1) {
			el.setAttribute('selected', !el.getAttribute('selected'));
		} else {
			el.focus();
		}
	};
	return {
		fix: fix
	}
}();

window.onload = function () {
	iPadLabels.fix();
	}
</script>	
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36886630-1']);
  _gaq.push(['_setDomainName', 'concussionjs.com']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/index.html written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrivejs/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
{ [Error: ENOENT, no such file or directory '/home/concussed/concussionjs-testdrivejs/manageLogin.js']
  errno: 34,
  code: 'ENOENT',
  path: '/home/concussed/concussionjs-testdrivejs/manageLogin.js' }
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 21054
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-21053, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 21188
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-21187, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".setHeight(10);");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.setHeight(editor.getSession().getDocument().getLength() *
			editor.renderer.lineHeight + editor.renderer.scrollBar.getWidth());
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 17293
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-17292, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".setHeight(10);");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 17423
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-17422, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".setHeight(10);");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 17496
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-17495, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".setHeight(10);");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 17628
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-17627, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 17701
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-17700, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 18521
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-18520, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 19566
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-19565, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 22486
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-22485, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 22559
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-22558, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".style.width=400px;");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 22748
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-22747, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".style.width=100%;");
		//eval(editors[i].id + ".style.width=400px;");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 22821
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-22820, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".style.width='100%';");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23010
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23009, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".style.width='100%';");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23083
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23082, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".style.width='100%';");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23156
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23155, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".style.width=100;");
		eval(editors[i].id + ".renderer.getHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23229
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23228, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".style.width=100;");
		eval(editors[i].id + ".renderer.setHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23245
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23244, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
		eval(editors[i].id + ".renderer.setHScrollBarAlwaysVisible();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23319
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23318, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 23507
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-23506, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 24623
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-24622, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 3955
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-3954, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 9090
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-9089, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 32300
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-32299, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 32695
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-32694, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"));
			aceEditorInit($(".snippet"));
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"ace/theme/concussion\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");
		//eval(editors[i].id + ".resize();");
	}
}
function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 869
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-868, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts_create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts_name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts_email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts_phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts_birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts_update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts_delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:contacts.update\">Save</button><button class=\"secondary\" data-bind=\"click:contacts.delete\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 3311
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-3310, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 21494
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-21493, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button>\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 21854
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-21853, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 29465
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-29464, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
        $('#auth-logoutlink').click(function(){FB.logout();}); 
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 1777
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-1776, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 9206
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-9205, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<!--script src="http://testdrive.concussionjs.com/assets/js/cjs-utilities.js"></script-->
		<script src="http://testdrive.concussionjs.com/jquery-1.8.1.min.js"></script>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts_create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts_Name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts_phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts_emailAddress">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:Name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:contacts_update">Save</button><button class="secondary" data-bind="click:contacts_delete">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 10106
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-10105, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts_create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts_Name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts_phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts_emailAddress">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:Name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:contacts_update">Save</button><button class="secondary" data-bind="click:contacts_delete">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 10198
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-10197, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts_create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts_Name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts_phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts_emailAddress">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:Name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:contacts_update">Save</button><button class="secondary" data-bind="click:contacts_delete">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 10272
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-10271, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 10346
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-10345, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://github.com/guillaumepotier/Parsley.js/blob/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 14274
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-14273, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://raw.github.com/guillaumepotier/Parsley.js/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 14405
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-14404, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://raw.github.com/guillaumepotier/Parsley.js/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create" data-validate="parsley">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 14503
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-14502, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://raw.github.com/guillaumepotier/Parsley.js/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create" data-validate="parsley">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name" data-required="true">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber" data-required="true">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
mon : write mon pid to /home/concussed/concussionjs-core/log/testdrive-mon.pid
mon : child 14904
mon : write pid to /home/concussed/concussionjs-core/log/testdrive.pid
mon : shutting down
mon : kill(-14903, 15)
mon : bye :)
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://raw.github.com/guillaumepotier/Parsley.js/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create" data-validate="parsley">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name" data-required="true">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber" data-required="true">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
port: 27017
/home/concussed/concussionjs-testdrive/desktopExample.ejs   /home/concussed/concussionjs-testdrive/desktopExample.htm

<html>
	<head>
		<script language="JavaScript" src="http://api.local-concussionjs.com/concussion.js"></script>
        <script language="JavaScript" src="https://raw.github.com/guillaumepotier/Parsley.js/master/parsley.js"></script>
    	<title>Contacts</title>
    	<meta charset="utf-8">
    	<link rel="stylesheet" href="http://testdrive.local-concussionjs.com/css/contacts-style.css">
	</head>
	<body>
        <form data-bind="submit:contacts.create" data-validate="parsley">
        <div class="new-contact">
			<input class="fn" name="fn" type="text" placeholder="Contact Names" data-bind="value:contacts.name" data-required="true">
			<input class="tel" name="tel" type="text" placeholder="Phone Number" data-bind="value:contacts.phoneNumber" data-required="true">
			<input class="email" name="email" type="text" placeholder="Email Address" data-bind="value:contacts.emailAddress" data-trigger="change" data-required="true" data-type="email">
            <button type="submit" value="Save">Add record</button>    
	    </div>
        </form>
	    <div id="contacts" data-bind="foreach:contacts.read">
            <div class="vcard" onclick="selectVcard(this)">
    			<input class="fn" data-bind="value:name">
    			<input class="tel" data-bind="value:phoneNumber">
                <input class="email" data-bind="value:emailAddress">
                <button data-bind="click:update">Save</button><button class="secondary" data-bind="click:remove">Delete</button>
    		</div>
        </div>
 </body>

 <script>
        function selectVcard(me)
        {
            $(".new-contact, .vcard").removeClass("selected");
            $(me).addClass("selected");
            event.stopPropagation();
        }
        
        $(document).ready(function(){
            $("body").on("click", function(event){
               //alert("clicked body");
                $(".new-contact, .vcard").removeClass("selected");
            });
        });
     </script>
</html>
/home/concussed/concussionjs-testdrive/manageLogin.ejs   /home/concussed/concussionjs-testdrive/js/manageLogin.js
		var myId="";
		var editor;
		 (function(d){
 		    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 		    if (d.getElementById(id)) {return;}
 		    js = d.createElement('script'); js.id = id; js.async = true;
 		    js.src = "//connect.facebook.net/en_US/all.js";
 		    ref.parentNode.insertBefore(js, ref);
 		  }(document));

 		window.fbAsyncInit = function() {
 		   FB.init({
		 	 appId      : '231629423618271', // App ID
 		     //channelUrl : 'http://concussionjs.COM/channel.html', // Channel File
 		     status     : true, // check login status
 		     cookie     : true, // enable cookies to allow the server to access the session
 		     xfbml      : true  // parse XFBML
 		   });
		
 		   // Additional initialization code here

 		 // Load the SDK Asynchronously
 		

 		    // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
        	//alert(JSON.stringify(response));
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
         		//alert(JSON.stringify(me));
				myId = me.id;
				//alert(myId);
				if (me.name) {
					document.getElementById('auth-displayname').innerHTML = me.name;
				}
				createCookie("sessionId",myId,1);
				getPage(myId,"index",submitFormData);
				synchSessionVariables(myId);
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        $('#masthead-icon-facebook').click(function(){FB.login();});
        $('#facebook-signup').click(function(){FB.login();});
		$('#masthead-icon-logout').click(function(){FB.logout();});
      } 

		
		$(document).ready(function(){
			//justDoIt=$(".justDoItContent");
			aceEditorInit($(".editor"),"ace/theme/concussion");
			aceEditorInit($(".snippet"),"ace/theme/concussion-snippet");
			myId=readCookie("sessionId");
			$(".justDoIt").click(justDoItForMe);
			$(".continue").click(justSubmit);
			//$("#addedBinds").click(addThreeContactRecords);

			/*editor = ace.edit("editor");
			editor.setTheme("ace/theme/concussion");
			editor.getSession().setMode("ace/mode/html");
			editor.setShowPrintMargin(false);*/
			if(!readCookie("sessionId"))
			{
				//alert("inside no cookie");
				createUUID(function(uuid)
				{
					createCookie("sessionId",uuid,1);
					synchSessionVariables(uuid);
				});
			}

			if(!myId)
			{	
				console.log("No authenticated user or session");
				editor.getSession().setValue("");
				submitFormData(readCookie("sessionId"));
			}
			else
			{
				console.log("myId:", myId);
				getPage(myId,"index",submitFormData);
			}

			$("#panel-header-icon-refresh").click(function(event){
					//alert("clicked");
					submitFormData();
			});	
		});

function justSubmit()
{
	console.log("justSubmit()");
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustSubmit', readCookie("sessionId")]);
	
	/*if(this.getAttribute("data-addContacts")=="true")
	{
		addThreeContactRecords();
	}*/
	submitFormData();
}

function justDoItForMe()
{
	_gaq.push(['_trackEvent', 'TutorialAction', 'JustDoItForME', readCookie("sessionId")]);
	editor.getSession().setValue(justDoIt[this.getAttribute("data-index")]);

	submitFormData();

}

function addThreeContactRecords()
{
	addSampleRecords(3,"contacts",readCookie("sessionId"));
}

function addSampleRecords(number,type,id)
{	
	for(i=0;i<number;i++)
	{
		var objectId="id_" + id + "_" + type;
		var nameVar = objectId + "_name";
		var emailVar = objectId + "_email";
		var phoneVar = objectId + "_phone";
		var nameVal = "name" + i;
		var emailVal = "email" + i;
		var phoneVal = "phone" + i;
		contact = "{\"" + nameVar + "\":\"" + nameVal + "\",\"" + emailVar + "\":\"" + emailVal + "\",\"" + phoneVar + "\":\"" + phoneVal + "\"}";

		$.ajax("http://api.local-concussionjs.com/createInstance/" + objectId, {
            data: contact,
            type: "POST",
            success: function(result) 
			{ 
					console.log("record successfully added record " + i);	
			}
        });
	}
}

function aceEditorInit(editors,themePath)
{
	console.log(editors.length);
	for(i=0;i<editors.length;i++)
	{
		console.log(editors[i].id + " "+ editors[i].getAttribute("data-readonly"));
		eval(editors[i].id + "=ace.edit(\"" + editors[i].id + "\");");
		eval(editors[i].id + ".setTheme(\"" + themePath + "\");");
		eval(editors[i].id + ".getSession().setMode(\"ace/mode/html\");");
		eval(editors[i].id + ".setShowPrintMargin(false);");
		eval(editors[i].id + ".setReadOnly(" + editors[i].getAttribute("data-readonly") + ");");
		eval(editors[i].id + ".renderer.setShowGutter(" + editors[i].getAttribute("data-gutter") + ");");

		//eval(editors[i].id + ".resize();");
	}
}

function getPage(userId,filename,callback)
{
	synchSessionVariables(userId);
	$.ajax({
		//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
         url: "http://api.local-concussionjs.com/getEntryWhere/pages?id="+userId+"&name="+filename,
         type: "get", 
         dataType:"text",
         success: function(result) 
		{ 
			var obj = JSON.parse(result)
			//alert(""+obj.html);
			editor.getSession().setValue(obj.html);
			editor.resize();
			if(callback)
				callback();
		}
   	});
}

	function synchSessionVariables(id)
	{
		$("#synchSessionVariables").attr({"src":"http://api.local-concussionjs.com/setSessionVariables.html?sid="+ id});
	}

	function submitFormData(id)
	{
		//alert($("#codeArea").attr("value"));
		//alert(editor.getSession().getValue());
		var page={};
		if(id)
		{
			myId = id;
		}
		page.id = myId;
		page.html = editor.getSession().getValue();
		page.name="index"
		//alert(JSON.stringify(page));
		$.ajax({
			//url: "http://testdrive.shift.com/getMergedJSandHTML/"+sessionId,
        	url: "http://api.local-concussionjs.com/updateWhere/pages?id="+myId,
        	data: JSON.stringify(page),//$("#codeArea").value,
    		type: "post", 
    		success: function(result) 
			{	 
				//alert(result);
				$("#preview").attr({"src":"http://api.local-concussionjs.com/getPage/"+ myId + "/index"});
				$("#admin-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				$("#admin-console-app").attr({"src":"http://api.local-concussionjs.com/admin.html?id="+ myId});
				synchSessionVariables(myId);
			}
		});
	}

	function openUpPreviewWindow()
	{
		window.open("http://api.local-concussionjs.com/getpage/"+ myId + "/index");
	}
/home/concussed/concussionjs-testdrive/loadEditorContent.ejs   /home/concussed/concussionjs-testdrive/js/loadEditorContent.js
var justDoIt=[];
justDoIt[0]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\"></head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[6]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" value=\"First Last\">\n\
      <input class=\"email\" value=\"address@email.com\">\n\
      <input class=\"tel\" value=\"+1.818.555.1212\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[1]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";

justDoIt[2]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[3]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[4]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
    </div>\n\
  </div>\n\
</div>\n\
</body>\n\
</html>";

justDoIt[5]="<!DOCTYPE html><html>\n\
<head><title>Contacts</title><meta charset=\"utf-8\"><link rel=\"stylesheet\" href=\"http://testdrive.local-concussionjs.com/css/contacts-style.css\">\n\
<script src=\"http://api.local-concussionjs.com/concussion.js\"></script>\n\
</head>\n\
<body>\n\
  <form data-bind=\"submit:contacts.create\">\n\
    <div class=\"new-contact\">\n\
      <input class=\"fn\" placeholder=\"Contact Name\" data-bind=\"value:contacts.name\">\n\
      <input class=\"email\" placeholder=\"Email Address\" data-bind=\"value:contacts.email\">\n\
      <input class=\"phone\" placeholder=\"Phone Number\" data-bind=\"value:contacts.phone\">\n\
      <input class=\"bday\" placeholder=\"Birthday\" data-bind=\"value:contacts.birthday\">\n\
      <button>Add record</button>\n\
    </div>\n\
  </form>\n\
  <div id=\"contacts\" data-bind=\"foreach:contacts.read\">\n\
    <div class=\"vcard\">\n\
      <input class=\"fn\" data-bind=\"value:name\">\n\
      <input class=\"email\" data-bind=\"value:email\">\n\
      <input class=\"tel\" data-bind=\"value:phone\">\n\
      <input class=\"bday\" data-bind=\"value:birthday\">\n\
      <button data-bind=\"click:update\">Save</button><button class=\"secondary\" data-bind=\"click:remove\">Delete</button> \n\
    </div>\n\
  </div>\n\
</body>\n\
</html>";
/home/concussed/concussionjs-testdrive/desktopExample.htm written successfully
/home/concussed/concussionjs-testdrive/js/manageLogin.js written successfully
/home/concussed/concussionjs-testdrive/js/loadEditorContent.js written successfully
